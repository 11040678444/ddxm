(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32f4cb7a"],{"24db":function(t,e,a){},2934:function(t,e,a){"use strict";a.d(e,"d",(function(){return n})),a.d(e,"b",(function(){return i})),a.d(e,"f",(function(){return s})),a.d(e,"e",(function(){return r})),a.d(e,"c",(function(){return l})),a.d(e,"a",(function(){return c})),a.d(e,"g",(function(){return u}));var o=a("b775");function n(t){return Object(o["a"])({url:"/stock/Base/search_item",method:"post",data:t})}function i(t){return Object(o["a"])({url:"/common/Brand/get_list",method:"post",data:t})}function s(t){return Object(o["a"])({url:"/stock/Shop/get_list",method:"get",params:t})}function r(){return Object(o["a"])({url:"/stock/supplier/getAllList",method:"post"})}function l(t){return Object(o["a"])({url:"/stock/Shop/get_list",method:"post",data:t})}function c(){return Object(o["a"])({baseURL:"http://192.168.25.104",url:"/common/item_company/getItemCompany",method:"post"})}function u(){return Object(o["a"])({baseURL:"http://192.168.25.104",url:"/common/shop/getShop",method:"post"})}},3804:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",staticStyle:{"line-height":"32px"},attrs:{slot:"header"},slot:"header"},[a("span",[t._v("添加商品到专题")])]),t._v(" "),a("el-form",{ref:"form",attrs:{"label-width":"auto"}},[a("el-form-item",{attrs:{label:"选择分类"}},[a("el-radio-group",{model:{value:t.requestData.st_id,callback:function(e){t.$set(t.requestData,"st_id",e)},expression:"requestData.st_id"}},t._l(t.typeList,(function(e,o){return a("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.title))])})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"选择商品"}},[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.choosesGoodsDialogShowHandle}},[t._v("选择")])],1),t._v(" "),a("el-form-item",[a("el-table",{ref:"multipleTable",attrs:{data:t.requestData.goodsList,border:"","header-cell-style":{backgroundColor:"#F5F7FA"},"element-loading-text":"Loading",stripe:"","max-height":"500"}},[a("el-table-column",{attrs:{label:"ID",align:"center",prop:"id"}}),t._v(" "),a("el-table-column",{attrs:{label:"商品名称",align:"center",prop:"title"}}),t._v(" "),a("el-table-column",{attrs:{label:"规格名称",align:"center",prop:"specification.key_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"商品图片",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{directives:[{name:"img",rawName:"v-img"}],staticStyle:{height:"100px"},attrs:{src:t.row.pic_url}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"原价",align:"center",prop:"specification.old_price"}}),t._v(" "),a("el-table-column",{attrs:{label:"售价",align:"center",prop:"specification.price"}}),t._v(" "),a("el-table-column",{attrs:{label:"新人专享价",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("input",{directives:[{name:"model",rawName:"v-model",value:e.row.price,expression:"scope.row.price"}],attrs:{type:"number"},domProps:{value:e.row.price},on:{input:function(a){a.target.composing||t.$set(e.row,"price",a.target.value)}}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.deleteChoosesGoods(e.$index)}}},[t._v("移除")])]}}])})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.add}},[t._v("提交")])],1)],1),t._v(" "),a("ChoosesGoods",{attrs:{isShow:t.choosesGoodsDialog.isShow},on:{"update:isShow":function(e){return t.$set(t.choosesGoodsDialog,"isShow",e)},"update:is-show":function(e){return t.$set(t.choosesGoodsDialog,"isShow",e)},submit:t.getChoosesGoods}})],1)},n=[],i=(a("309f"),a("0b53"),a("6d57"),a("6a8f")),s=a("e926"),r=a("a7ff"),l={name:"index",mixins:[i["a"]],data:function(){return{requestData:{st_id:"",goodsList:[]},choosesGoodsDialog:{isShow:!1}}},methods:{choosesGoodsDialogShowHandle:function(){this.choosesGoodsDialog.isShow=!0},deleteChoosesGoods:function(t){this.requestData.goodsList.splice(t,1);this.requestData.goodsList[t].id},getChoosesGoods:function(t){t.map((function(t){t.price="",t.old_price=t.specification.old_price,t.id_attr_ids=t.id+"_"+t.specification.key}));var e=this.requestData.goodsList.concat(t),a={};e=e.reduce((function(t,e){return!a[e.id_attr_ids]&&(a[e.id_attr_ids]=t.push(e)),t}),[]),this.requestData.goodsList=e},add:function(){var t=this;if(this.requestData.st_id){var e=[],a=!0,o=!1,n=void 0;try{for(var i,s=this.requestData.goodsList[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var l=i.value;if(!l.price)return void this.$message({message:"".concat(l.title," 未设置新人专享价"),type:"error"});e.push({item_id:l.id,item_name:l.title,item_pic:l.pic,old_price:l.specification.old_price,price:l.price,attr_ids:l.specification.key||"",attr_name:l.specification.key_name||""})}}catch(c){o=!0,n=c}finally{try{a||null==s.return||s.return()}finally{if(o)throw n}}e.length?Object(r["a"])({st_id:this.requestData.st_id,item:e}).then((function(e){200===e.code&&(t.requestData.st_id="",t.requestData.goodsList=[],t.$message({message:"添加成功",type:"success"}))})).catch((function(t){console.log(t)})):this.$message({message:"请选择商品",type:"error"})}else this.$message({message:"请选择分类",type:"error"})}},components:{ChoosesGoods:s["a"]}},c=l,u=(a("6a64"),a("5511")),d=Object(u["a"])(c,o,n,!1,null,"51b77cbc",null);e["default"]=d.exports},"4d75":function(t,e,a){"use strict";a.d(e,"g",(function(){return n})),a.d(e,"e",(function(){return i})),a.d(e,"f",(function(){return s})),a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return l})),a.d(e,"b",(function(){return c})),a.d(e,"c",(function(){return u}));var o=a("b775");function n(t){return Object(o["a"])({url:"/mall_admin_market/Special/getTypeList",method:"post",data:t})}function i(t){return Object(o["a"])({url:"/mall_admin_market/Special/typeAdd",method:"post",data:t})}function s(t){return Object(o["a"])({url:"/mall_admin_market/Special/deleteType",method:"post",data:t})}function r(t){return Object(o["a"])({url:"/mall_admin_market/Special/add_item",method:"post",data:t})}function l(t){return Object(o["a"])({url:"/mall_admin_market/Special/getItemList",method:"post",data:t})}function c(t){return Object(o["a"])({url:"/mall_admin_market/Special/deleteItem",method:"post",data:t})}function u(t){return Object(o["a"])({url:"/mall_admin_market/Special/setHot",method:"post",data:t})}},"6a64":function(t,e,a){"use strict";var o=a("24db"),n=a.n(o);n.a},"6a8f":function(t,e,a){"use strict";var o=a("4d75");e["a"]={data:function(){return{typeList:[]}},methods:{getTypeList:function(){var t=this,e={type:2};Object(o["g"])(e).then((function(e){200===e.code&&(t.typeList=e.data.data)})).catch((function(t){console.log(t)}))}},created:function(){this.getTypeList()}}},a7ff:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"d",(function(){return i})),a.d(e,"b",(function(){return s})),a.d(e,"e",(function(){return r})),a.d(e,"c",(function(){return l}));var o=a("b775");function n(t){return Object(o["a"])({url:"/mall_admin_market/Exclusive/addItem",method:"post",data:t})}function i(t){return Object(o["a"])({url:"/mall_admin_market/Exclusive/itemList",method:"post",data:t})}function s(t){return Object(o["a"])({url:"/mall_admin_market/Exclusive/delItems",method:"post",data:t})}function r(t){return Object(o["a"])({url:"/mall_admin_market/Exclusive/setHot",method:"post",data:t})}function l(t){return Object(o["a"])({url:"/mall_admin_market/Exclusive/editItem",method:"post",data:t})}},b8a4:function(t,e,a){"use strict";var o=a("d836"),n=a.n(o);n.a},d836:function(t,e,a){},e926:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{width:"55%",title:"商品选择",visible:t.show,"append-to-body":""},on:{"update:visible":function(e){t.show=e},close:t.closeDialog}},[a("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"search-box"},[a("el-input",{staticClass:"search-input with",attrs:{clearable:"",size:"small",placeholder:"商品名称"},model:{value:t.requestData.item_name,callback:function(e){t.$set(t.requestData,"item_name",e)},expression:"requestData.item_name"}}),t._v(" "),a("el-input",{staticClass:"search-input with",attrs:{clearable:"",size:"small",placeholder:"条形码"},model:{value:t.requestData.bar_code,callback:function(e){t.$set(t.requestData,"bar_code",e)},expression:"requestData.bar_code"}}),t._v(" "),a("el-radio-group",{staticStyle:{"margin-right":"20px"},model:{value:t.requestData.item_type,callback:function(e){t.$set(t.requestData,"item_type",e)},expression:"requestData.item_type"}},[a("el-radio",{attrs:{label:1,size:"medium"}},[t._v("线上商品")]),t._v(" "),a("el-radio",{attrs:{label:2,size:"medium",disabled:t.isDisabled}},[t._v("门店商品")])],1),t._v(" "),a("el-button",{staticClass:"search-input",attrs:{size:"small",icon:"el-icon-search",type:"primary"},on:{click:t.search}},[t._v("搜索")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.requestData.isLoad,expression:"requestData.isLoad"}],ref:"multipleTable",attrs:{data:t.responseData,border:"","header-cell-style":{backgroundColor:"#F5F7FA"},"element-loading-text":"Loading",stripe:"","max-height":"400","span-method":t.objectSpanMethod},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"ID",align:"center",prop:"id"}}),t._v(" "),a("el-table-column",{attrs:{label:"商品名称",align:"center",prop:"title"}}),t._v(" "),a("el-table-column",{attrs:{label:"规格",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.specification.key_name))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"条形码",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.specification.bar_code))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"库存",align:"center",prop:"stock"}})],1),t._v(" "),a("div",{staticClass:"footer"},[a("el-pagination",{attrs:{"current-page":t.requestData.page,"page-sizes":[5,10,15,20],"page-size":t.requestData.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.totalCount,"hide-on-single-page":!0},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-button",{staticStyle:{float:"right",margin:"20px"},attrs:{type:"primary",size:"small"},on:{click:t.submit}},[t._v("确定")])],1)],1)],1)},n=[],i=(a("6d57"),a("0bbb")),s=(a("63ff"),a("57f0")),r=a("2934"),l={name:"ChoosesGoods",props:{isShow:{type:Boolean,default:!1},chooeseArr:{type:Array,default:function(){return[]}},isDisabled:{type:Boolean,default:!1}},watch:{isShow:{immediate:!0,handler:function(t){console.log("我是父组件带过来的值",t),console.log("选中ID数组",this.chooeseArr),this.show=t,this.requestData.not_ids=this.chooeseArr}},show:function(t,e){t||this.$emit("update:isShow",!1)}},data:function(){return{show:!1,isLoad:!1,requestData:{page:1,limit:5,item_type:1,item_name:"",brand_id:"",bar_code:"",shop_id:"",stock:"",not_ids:[]},multipleSelection:[],spanArr:[],position:0,totalCount:0,responseData:[]}},created:function(){},methods:{closeDialog:function(){this.show=!1,this.responseData=[],this.requestData={page:1,limit:5,item_type:1,item_name:"",brand_id:"",bar_code:"",shop_id:"",stock:"",not_ids:[]}},search:function(){this.requestData.page=1,this.loadData()},handleCurrentChange:function(t){this.requestData.page=t,this.loadData()},handleSizeChange:function(t){this.requestData.limit=t,this.loadData()},loadData:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.totalCount=0,this.responseData=[],this.spanArr=[],this.position=0,this.isLoad=!0,t.next=7,Object(r["d"])(this.requestData).then((function(t){if(200===t.code){e.totalCount=t.count;var a=[],o=[];t.data.map((function(t){o=[],t.specs.map((function(e){o.push(Object.assign({specification:e},t))})),a.push.apply(a,Object(i["a"])(o))})),e.responseData=a,e.rowspan(),console.log("处理数据结构后：",a)}e.isLoad=!1})).catch((function(t){e.isLoad=!1,console.log(t)}));case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),rowspan:function(){var t=this;this.responseData.forEach((function(e,a){0===a?(t.spanArr.push(1),t.position=0):t.responseData[a].id===t.responseData[a-1].id?(t.spanArr[t.position]+=1,t.spanArr.push(0)):(t.spanArr.push(1),t.position=a)}))},objectSpanMethod:function(t){t.row,t.column;var e=t.rowIndex,a=t.columnIndex;if(1===a){var o=this.spanArr[e],n=o>0?1:0;return{rowspan:o,colspan:n}}if(2===a){var i=this.spanArr[e],s=i>0?1:0;return{rowspan:i,colspan:s}}},handleSelectionChange:function(t){this.multipleSelection=t,console.log(t)},submit:function(){this.$emit("submit",this.multipleSelection),this.show=!1,this.responseData=[]}}},c=l,u=(a("b8a4"),a("5511")),d=Object(u["a"])(c,o,n,!1,null,"e6a9457e",null);e["a"]=d.exports}}]);