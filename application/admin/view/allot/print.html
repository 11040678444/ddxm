<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <link rel="stylesheet" href="__STATIC__/libs/layui/css/layui.css">
    <link rel="stylesheet" type="text/css" href="lib/layui/css/layui.css"/>
    <script src="__STATIC__/libs/layui/layui.js"></script>
    <script src="__STATIC__/libs/jquery/jquery.min.js"></script>
    <script language="javascript">
        function preview(oper)
        {
            if (oper < 10){
                bdhtml=window.document.body.innerHTML;//获取当前页的html代码
                sprnstr="<!--startprint"+oper+"-->";//设置打印开始区域
                eprnstr="<!--endprint"+oper+"-->";//设置打印结束区域
                prnhtml=bdhtml.substring(bdhtml.indexOf(sprnstr)+18); //从开始代码向后取html
                prnhtml=prnhtml.substring(0,prnhtml.indexOf(eprnstr));//从结束代码向前取html
                window.document.body.innerHTML=prnhtml;
                window.print();
                window.document.body.innerHTML=bdhtml;
            } else {
                window.print();
            }
        }
    </script>
</head>
<body>
    <!--startprint1-->
    <!--打印内容开始-->
    <style type="text/css">
        .layui-tab{
            padding-left:40px;
            padding-right:20px;
            padding-bottom:20px;

           /* margin-top: 100px;*/
        }
        .layui-this{
            background-color: orange;
        }
        .one{
            display: flex;
            justify-content: space-between;
            height: 20px;
            line-height: 20px;
            margin-top: 15px;
            margin-bottom: 15px;
        }
        .one span{
            width: 25%;
            text-align: left;
            overflow: hidden;
        }
        .two{
            display: flex;
            justify-content: flex-start;
            height: 20px;
            line-height: 20px;
        }
       .table{
            padding-right:20px;
            padding-top:10px;
            /* height: 100%; 
            width: 100%;*/
        }
        .table table{
            height: 100%;
            width: 100%;
        }
        .table table tr{
            height: 36px;
            width: 100%;
        }
       .table table td{
            border: 1px solid #666;
            border-top:none; 
            border-right: none;
            text-align: center;
            vertical-align: middle;
        }
        .table table th{
            border-top: 1px solid #cccccc;
        }
        .table table td:first-child{
            border-right: 1px solid #666;
        }
        .table table td:last-child{
            border-right: 1px solid #666;
        }
    </style>
    <div class="layui-tab">
        <div style="width: 900px;"> <!--  class="layui-tab-content" -->
            <div style="text-align: center;font-weight:400;font-size: 20px;">捣蛋熊猫调拨单</div>
            <div class="one" ><!-- layui-tab-item layui-show -->
                <span>调拨单号：{$data.sn}</span>
                <span>调出仓库：{$data.out_shop}</span>
                <span>调入仓库：{$data.in_shop}</span>
                <span>调拨时间：{$data.create_time}</span>
            </div>
            <div class="two">
                <span>备注：{$data.remark ==""?"无":$data.remark}</span>
            </div>
            <div class="table">
                <table cellspacing="0" cellpadding="0" border="1" align="center" id="informationtable">
                    <tr class="row1">
                      <td>序号</td>
                      <td>商品名称</td>
                      <td>条形码</td>
                      <td>发货数量</td>
                    </tr>
                  </table>
                <table class="layui-table"lay-filter="table" id="table">
                </table>
            </div>
            <div class="one">
                <span>制单人：{$data.worker}</span>
                <span>配货人：</span>
                <span>发货人：</span>
                <span>收货人：</span>
            </div>
        </div>
     
    </div>
 <!--打印内容结束-->
<!--endprint1-->
<div class="layui-inline" title="打印"  onclick=preview(1)  style="float:right;margin-right:30px; clear:both;"><i class="layui-icon  layui-icon-print" style="font-size: 30px; color: gray;"></i></div>
<script>
    $(document).ready(function (){
        var id = "{$data.id}";
        $.ajax({
            type: "POST",
            url: "{:url('admin/allot/print_item')}",
            contentType: 'application/x-www-form-urlencoded;charset=utf-8',
            data: {id:id},
            dataType: "json",
            success: function(res){
                if(res.result){
                    var length = res.data.length;
                    var html ="";
                    for(var i = 0;i<length;i++){
                        var num = i+1;
                        html +="<tr>";
                        html +=`<td>`+num+`</td>
                        <td>`+res.data[i].item+`</td>
                        <td>`+res.data[i].bar_code+`</td>
                        <td>`+res.data[i].num+`</td>`;
                        html += "</tr>";
                    }
                    $("#informationtable").append(html);
                }else{
                    alert(res.msg);
                }
            },
            error:function(e){
                alert(e);
            }
        });
    });
    layui.use(['element',"table"], function(){
        var element = layui.element;
    });
</script>
</body>
</html>